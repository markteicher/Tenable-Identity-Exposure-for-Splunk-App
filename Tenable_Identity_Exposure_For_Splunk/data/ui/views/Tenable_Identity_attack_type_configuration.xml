<!--
=============================================================================
 default/data/ui/views/Tenable_Identity_attack_type_configuration.xml
 Tenable Identity Exposure for Splunk App
 üß† Attack Type Configuration
=============================================================================

PURPOSE

Displays attack type configuration state for Tenable Identity Exposure.
This view provides executive visibility into which attack types are
enabled, disabled, or automatically limited for performance, followed
by detailed configuration records for operational review.

DATA SOURCE

GET /api/attack-type-configuration
‚Üí sourcetype=tenable:identity_exposure:attack_type_configuration

FIELDS

- version
- configuration{}.attackTypeId
- configuration{}.directoryId
- configuration{}.detectedEvents
- configuration{}.autoDisabledForPerfAt
- permissions.canEdit

=============================================================================
-->

<dashboard version="1.1" theme="light">
  <label>üß† Attack Type Configuration</label>

  <!-- =============================================================== -->
  <!-- ROW 1: EXECUTIVE SUMMARY                                        -->
  <!-- =============================================================== -->
  <row>

    <panel>
      <title>üì¶ Configuration Version</title>
      <single>
        <search>
          <query>
            index=* sourcetype=tenable:identity_exposure:attack_type_configuration
            | stats latest(version) as version
          </query>
        </search>
      </single>
    </panel>

    <panel>
      <title>üö® Enabled Attack Types</title>
      <single>
        <search>
          <query>
            index=* sourcetype=tenable:identity_exposure:attack_type_configuration
            | spath
            | mvexpand configuration
            | search configuration.detectedEvents=true
            | stats count
          </query>
        </search>
      </single>
    </panel>

    <panel>
      <title>üßä Auto-Disabled for Performance</title>
      <single>
        <search>
          <query>
            index=* sourcetype=tenable:identity_exposure:attack_type_configuration
            | spath
            | mvexpand configuration
            | search isnotnull(configuration.autoDisabledForPerfAt)
            | stats count
          </query>
        </search>
      </single>
    </panel>

    <panel>
      <title>‚úèÔ∏è Editable Configuration</title>
      <single>
        <search>
          <query>
            index=* sourcetype=tenable:identity_exposure:attack_type_configuration
            | spath
            | stats latest(permissions.canEdit) as canEdit
          </query>
        </search>
      </single>
    </panel>

  </row>

  <!-- =============================================================== -->
  <!-- ROW 2: CONFIGURATION DISTRIBUTION                               -->
  <!-- =============================================================== -->
  <row>

    <panel>
      <title>üß≠ Attack Types by Directory</title>
      <chart>
        <search>
          <query>
            index=* sourcetype=tenable:identity_exposure:attack_type_configuration
            | spath
            | mvexpand configuration
            | stats count by configuration.directoryId
            | sort - count
          </query>
        </search>
        <option name="charting.chart">bar</option>
        <option name="charting.legend.placement">none</option>
      </chart>
    </panel>

    <panel>
      <title>‚öôÔ∏è Detection State</title>
      <chart>
        <search>
          <query>
            index=* sourcetype=tenable:identity_exposure:attack_type_configuration
            | spath
            | mvexpand configuration
            | eval state=if(configuration.detectedEvents=true,"Enabled","Disabled")
            | stats count by state
          </query>
        </search>
        <option name="charting.chart">pie</option>
        <option name="charting.legend.placement">right</option>
      </chart>
    </panel>

  </row>

  <!-- =============================================================== -->
  <!-- ROW 3: CONFIGURATION DETAIL                                     -->
  <!-- =============================================================== -->
  <row>
    <panel>
      <title>üîç Attack Type Configuration Details</title>
      <table>
        <search>
          <query>
            index=* sourcetype=tenable:identity_exposure:attack_type_configuration
            | spath
            | mvexpand configuration
            | table
                configuration.attackTypeId
                configuration.directoryId
                configuration.detectedEvents
                configuration.autoDisabledForPerfAt
            | sort configuration.attackTypeId
          </query>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">true</option>
        <option name="count">25</option>
      </table>
    </panel>
  </row>

</dashboard>
